package com.bquarkz.simplecsv;

import java.nio.charset.Charset;
import java.nio.charset.StandardCharsets;

import static java.util.Optional.ofNullable;

public class CSVExporterBuilder< BEAN >
{
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Constants
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Special Fields And Injections
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Fields
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    private CSVParser< BEAN > csvParser;
    private CSVDelimiters delimiters;

    private Boolean shouldWriteHeader;
    private Charset charset;

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Constructors
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    CSVExporterBuilder( CSVParser< BEAN > csvParser )
    {
        this.csvParser = csvParser;
        this.delimiters = new CSVDelimiters();
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Factories
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Getters And Setters
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    CSVDelimiters getDelimiters()
    {
        return delimiters;
    }

    CSVParser< BEAN > getCsvParser()
    {
        return csvParser;
    }

    boolean shouldWriteHeader()
    {
        return ofNullable( shouldWriteHeader ).orElse( csvParser.shouldWriteHeader() );
    }

    Charset getCharset()
    {
        return ofNullable( charset ).orElse( StandardCharsets.UTF_8 );
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Methods
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    public CSVExporterBuilder< BEAN > withDelimiters( CSVDelimiters delimiters )
    {
        this.delimiters = delimiters;
        return this;
    }

    public CSVExporterBuilder< BEAN > usingParser( CSVParser< BEAN > csvParser )
    {
        this.csvParser = csvParser;
        return this;
    }

    public CSVExporterBuilder< BEAN > shouldWriteHeader( boolean shouldWriteHeader )
    {
        this.shouldWriteHeader = shouldWriteHeader;
        return this;
    }

    public CSVExporterBuilder< BEAN > usingCharset( Charset charset )
    {
        this.charset = charset;
        return this;
    }

    public CSVExporter< BEAN > build()
    {
        return new CSVExporter<>( this );
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    // Inner Classes And Patterns
    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}
